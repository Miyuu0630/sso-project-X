# SSO 项目目录结构重构方案 - 基于现有架构

## 🎯 重构目标

基于现有的 **服务端(S端)** + **客户端前后端(C端)** 架构，优化目录结构，消除功能重复，提高代码复用性。

## 🔄 重构后的目录结构

```
sso-project-X/
├── pom.xml                               # 父项目POM文件（新增）
├── README.md                             # 项目主说明文档
├── .gitignore                            # Git忽略文件
├── docker-compose.yml                    # Docker编排文件（新增）
│
├── shared/                               # 共享资源目录（新增）
│   ├── db/                              # 数据库相关文件
│   │   ├── schema/                      # 数据库表结构
│   │   │   ├── 01_sso_core.sql         # SSO核心表结构
│   │   │   ├── 02_user_system.sql      # 用户系统表结构
│   │   │   └── 03_business_tables.sql  # 业务表结构
│   │   ├── data/                        # 初始数据
│   │   │   ├── 01_system_data.sql      # 系统基础数据
│   │   │   └── 02_test_data.sql        # 测试数据
│   │   └── migrations/                  # 数据库迁移脚本
│   │
│   ├── config/                          # 统一配置文件（新增）
│   │   ├── application-common.yml       # 公共配置
│   │   ├── application-dev.yml          # 开发环境配置
│   │   ├── application-prod.yml         # 生产环境配置
│   │   └── logback-spring.xml           # 统一日志配置
│   │
│   └── docs/                            # 项目文档（重构）
│       ├── architecture/                # 架构设计文档
│       ├── development/                  # 开发指南
│       ├── deployment/                   # 部署文档
│       └── maintenance/                  # 运维文档
│
├── sso-server/                           # S端：SSO服务端（保持原名，优化内部结构）
│   ├── pom.xml                          # 模块POM文件
│   ├── README.md                         # 模块说明文档
│   └── src/
│       ├── main/
│       │   ├── java/org/example/ssoserver/
│       │   │   ├── SsoServerApplication.java # 主启动类
│       │   │   ├── config/               # 配置类
│       │   │   │   ├── SecurityConfig.java # 安全配置
│       │   │   │   ├── RedisConfig.java    # Redis配置
│       │   │   │   ├── SaTokenConfig.java  # Sa-Token配置
│       │   │   │   └── WebConfig.java      # Web配置
│       │   │   ├── controller/            # 控制器
│       │   │   │   ├── auth/              # 认证控制器
│       │   │   │   │   ├── AuthController.java # 认证控制器
│       │   │   │   │   └── SsoController.java  # SSO核心控制器
│       │   │   │   ├── user/              # 用户管理控制器
│       │   │   │   │   ├── UserController.java # 用户管理
│       │   │   │   │   └── RoleController.java # 角色管理
│       │   │   │   ├── permission/        # 权限控制器
│       │   │   │   │   └── PermissionController.java # 权限管理
│       │   │   │   └── system/            # 系统控制器
│       │   │   │       ├── LoginPageController.java # 登录页面
│       │   │   │       └── StaticResourceController.java # 静态资源
│       │   │   ├── service/               # 服务层
│       │   │   │   ├── auth/              # 认证服务
│       │   │   │   │   ├── AuthService.java
│       │   │   │   │   └── impl/
│       │   │   │   ├── user/              # 用户服务
│       │   │   │   │   ├── UserService.java
│       │   │   │   │   └── impl/
│       │   │   │   ├── permission/        # 权限服务
│       │   │   │   │   ├── PermissionService.java
│       │   │   │   │   └── impl/
│       │   │   │   └── device/            # 设备管理服务
│       │   │   │       ├── DeviceManagementService.java
│       │   │   │       └── impl/
│       │   │   ├── repository/            # 数据访问层
│       │   │   │   ├── entity/            # 实体类
│       │   │   │   │   ├── SysUser.java   # 系统用户
│       │   │   │   │   ├── SysRole.java   # 系统角色
│       │   │   │   │   ├── SysMenu.java   # 系统菜单
│       │   │   │   │   └── UserDevice.java # 用户设备
│       │   │   │   ├── repository/        # 数据访问接口
│       │   │   │   └── mapper/            # MyBatis映射器
│       │   │   ├── dto/                   # 数据传输对象
│       │   │   │   └── SsoTicketInfo.java # SSO票据信息
│       │   │   ├── exception/             # 异常处理
│       │   │   └── util/                  # 工具类
│       │   └── resources/
│       │       ├── application.yml        # 模块配置
│       │       ├── mapper/                # MyBatis映射文件
│       │       └── static/                # 静态资源
│       └── test/
│           └── java/org/example/ssoserver/
│               ├── config/                # 测试配置
│               ├── controller/            # 控制器测试
│               ├── service/               # 服务层测试
│               └── integration/           # 集成测试
│
├── sso-client-backend/                    # C端后端：客户端后端服务（优化内部结构）
│   ├── pom.xml                           # 模块POM文件
│   ├── README.md                          # 模块说明文档
│   └── src/
│       ├── main/
│       │   ├── java/org/example/ssoclient/
│       │   │   ├── SsoClientApplication.java # 主启动类
│       │   │   ├── config/                # 配置类
│       │   │   │   ├── SsoClientConfig.java # SSO客户端配置
│       │   │   │   ├── WebConfig.java      # Web配置
│       │   │   │   └── SecurityConfig.java # 安全配置
│       │   │   ├── controller/            # 控制器
│       │   │   │   ├── dashboard/         # 仪表板控制器
│       │   │   │   │   ├── DashboardController.java # 仪表板
│       │   │   │   │   └── StatsController.java # 统计信息
│       │   │   │   ├── user/              # 用户相关控制器
│       │   │   │   │   ├── ProfileController.java # 用户资料
│       │   │   │   │   ├── SecurityController.java # 安全设置
│       │   │   │   │   └── DeviceController.java # 设备管理
│       │   │   │   ├── business/          # 业务功能控制器
│       │   │   │   │   ├── airline/        # 航空业务
│       │   │   │   │   │   ├── FlightController.java # 航班管理
│       │   │   │   │   │   ├── PassengerController.java # 乘客管理
│       │   │   │   │   │   └── AirlineController.java # 航空公司
│       │   │   │   │   └── enterprise/     # 企业业务
│       │   │   │   │       ├── EnterpriseController.java # 企业管理
│       │   │   │   │       └── MemberController.java # 成员管理
│       │   │   │   └── system/            # 系统管理控制器
│       │   │   │       ├── MenuController.java # 菜单管理
│       │   │   │       ├── RoleController.java # 角色管理
│       │   │   │       └── LogController.java # 日志管理
│       │   │   ├── service/               # 服务层
│       │   │   │   ├── dashboard/         # 仪表板服务
│       │   │   │   ├── user/              # 用户服务
│       │   │   │   ├── business/          # 业务服务
│       │   │   │   │   ├── airline/        # 航空业务服务
│       │   │   │   │   └── enterprise/     # 企业业务服务
│       │   │   │   └── system/            # 系统管理服务
│       │   │   ├── repository/            # 数据访问层
│       │   │   │   ├── entity/            # 实体类
│       │   │   │   ├── repository/        # 数据访问接口
│       │   │   │   └── mapper/            # MyBatis映射器
│       │   │   ├── dto/                   # 数据传输对象
│       │   │   │   ├── MenuDTO.java       # 菜单DTO
│       │   │   │   ├── RoleInfoDTO.java   # 角色信息DTO
│       │   │   │   └── UserInfoDTO.java   # 用户信息DTO
│       │   │   ├── integration/           # 外部服务集成
│       │   │   │   └── sso/               # SSO集成
│       │   │   │       ├── SsoIntegrationService.java # SSO集成服务
│       │   │   │       └── impl/
│       │   │   └── util/                  # 工具类
│       │   └── resources/
│       │       ├── application.yml        # 模块配置
│       │       ├── mapper/                # MyBatis映射文件
│       │       └── static/                # 静态资源
│       └── test/
│           └── java/org/example/ssoclient/
│               ├── controller/            # 控制器测试
│               ├── service/               # 服务层测试
│               └── integration/           # 集成测试
│
├── sso-client-frontend/                   # C端前端：客户端前端界面（优化内部结构）
│   ├── package.json                       # 依赖配置
│   ├── vite.config.js                     # Vite配置
│   ├── README.md                          # 模块说明文档
│   └── src/
│       ├── main.js                        # 应用入口
│       ├── App.vue                        # 根组件
│       ├── router/                        # 路由配置
│       │   ├── index.js                   # 路由主文件
│       │   ├── auth.js                    # 认证路由
│       │   ├── dashboard.js               # 仪表板路由
│       │   ├── system.js                  # 系统管理路由
│       │   └── business.js                # 业务功能路由
│       ├── stores/                        # 状态管理
│       │   ├── auth.js                    # 认证状态
│       │   ├── user.js                    # 用户状态
│       │   └── app.js                     # 应用状态
│       ├── components/                    # 公共组件
│       │   ├── common/                    # 通用组件
│       │   │   ├── BaseTable.vue          # 基础表格
│       │   │   ├── BaseForm.vue           # 基础表单
│       │   │   └── BaseModal.vue          # 基础弹窗
│       │   ├── layout/                    # 布局组件
│       │   │   ├── Header.vue             # 头部组件
│       │   │   ├── Sidebar.vue            # 侧边栏
│       │   │   └── Footer.vue             # 底部组件
│       │   └── business/                  # 业务组件
│       │       ├── airline/               # 航空业务组件
│       │       └── enterprise/            # 企业业务组件
│       ├── views/                         # 页面视图（重构）
│       │   ├── auth/                      # 认证页面
│       │   │   ├── Login.vue              # 登录页面
│       │   │   ├── Callback.vue           # SSO回调处理
│       │   │   └── Logout.vue             # 登出页面
│       │   ├── dashboard/                 # 仪表板页面
│       │   │   ├── MainDashboard.vue      # 主仪表板
│       │   │   ├── AdminDashboard.vue     # 管理员仪表板
│       │   │   ├── AirlineDashboard.vue   # 航空公司仪表板
│       │   │   ├── EnterpriseDashboard.vue # 企业仪表板
│       │   │   └── PersonalDashboard.vue  # 个人仪表板
│       │   ├── system/                    # 系统管理页面
│       │   │   ├── user/                  # 用户管理
│       │   │   │   ├── UserList.vue       # 用户列表
│       │   │   │   ├── UserForm.vue       # 用户表单
│       │   │   │   └── UserDetail.vue     # 用户详情
│       │   │   ├── role/                  # 角色管理
│       │   │   │   ├── RoleList.vue       # 角色列表
│       │   │   │   └── RoleForm.vue       # 角色表单
│       │   │   ├── menu/                  # 菜单管理
│       │   │   │   ├── MenuList.vue       # 菜单列表
│       │   │   │   └── MenuForm.vue       # 菜单表单
│       │   │   └── log/                   # 日志管理
│       │   │       ├── LoginLog.vue       # 登录日志
│       │   │       └── OperationLog.vue   # 操作日志
│       │   ├── business/                  # 业务功能页面
│       │   │   ├── airline/               # 航空业务
│       │   │   │   ├── Flight.vue         # 航班管理
│       │   │   │   ├── Passenger.vue      # 乘客管理
│       │   │   │   └── Info.vue           # 公司信息
│       │   │   └── enterprise/            # 企业业务
│       │   │       ├── Auth.vue           # 企业认证
│       │   │       ├── Member.vue         # 成员管理
│       │   │       └── Info.vue           # 企业信息
│       │   ├── user/                      # 用户相关页面
│       │   │   ├── Profile.vue            # 用户资料
│       │   │   ├── Security.vue           # 安全设置
│       │   │   ├── Device.vue             # 设备管理
│       │   │   └── OAuth.vue              # OAuth管理
│       │   └── monitor/                   # 监控页面
│       │       ├── Online.vue             # 在线用户
│       │       └── Server.vue             # 服务器监控
│       ├── api/                           # API接口
│       │   ├── auth.js                    # 认证接口
│       │   ├── user.js                    # 用户接口
│       │   ├── system.js                  # 系统接口
│       │   ├── business.js                # 业务接口
│       │   └── dashboard.js               # 仪表板接口
│       ├── utils/                         # 工具函数
│       │   ├── request.js                 # HTTP请求
│       │   ├── auth.js                    # 认证工具
│       │   ├── date.js                    # 日期工具
│       │   └── common.js                  # 通用工具
│       └── config/                        # 配置文件
│           ├── sso.js                     # SSO配置
│           ├── app.js                     # 应用配置
│           └── constants.js               # 常量配置
│
├── sso-common/                            # 公共模块（优化）
│   ├── pom.xml                            # 模块POM文件
│   ├── README.md                           # 模块说明文档
│   └── src/
│       └── main/java/org/example/common/
│           ├── annotation/                # 注解定义
│           ├── config/                    # 配置类
│           ├── constant/                  # 常量定义（统一命名）
│           │   ├── CommonConstants.java   # 通用常量
│           │   ├── SecurityConstants.java # 安全常量
│           │   ├── BusinessConstants.java # 业务常量
│           │   └── ApiConstants.java      # API常量
│           ├── dto/                       # 数据传输对象
│           │   ├── base/                  # 基础DTO
│           │   │   ├── BaseRequest.java   # 基础请求
│           │   │   ├── BaseResponse.java  # 基础响应
│           │   │   └── PageRequest.java   # 分页请求
│           │   ├── auth/                  # 认证相关DTO
│           │   │   ├── LoginRequest.java  # 登录请求
│           │   │   └── LoginResponse.java # 登录响应
│           │   ├── user/                  # 用户相关DTO
│           │   │   ├── UserDTO.java       # 用户DTO
│           │   │   ├── RoleDTO.java       # 角色DTO
│           │   │   └── MenuDTO.java       # 菜单DTO
│           │   └── business/              # 业务相关DTO
│           ├── entity/                    # 实体类
│           │   └── base/                  # 基础实体
│           ├── enums/                     # 枚举定义
│           │   ├── common/                # 通用枚举
│           │   │   ├── StatusEnum.java    # 状态枚举
│           │   │   └── TypeEnum.java      # 类型枚举
│           │   ├── auth/                  # 认证枚举
│           │   │   ├── LoginType.java     # 登录类型
│           │   │   └── OAuthProvider.java # OAuth提供商
│           │   ├── user/                  # 用户枚举
│           │   │   ├── Gender.java        # 性别枚举
│           │   │   └── UserType.java      # 用户类型
│           │   └── business/              # 业务枚举
│           │       ├── DeviceType.java    # 设备类型
│           │       └── SecurityEventType.java # 安全事件类型
│           ├── exception/                 # 异常处理
│           │   ├── base/                  # 基础异常
│           │   │   ├── BaseException.java # 基础异常
│           │   │   └── BusinessException.java # 业务异常
│           │   ├── auth/                  # 认证异常
│           │   └── system/                # 系统异常
│           ├── interceptor/               # 拦截器
│           ├── mapper/                    # 数据映射器
│           ├── model/                     # 数据模型
│           │   ├── base/                  # 基础模型
│           │   ├── auth/                  # 认证模型
│           │   └── business/              # 业务模型
│           ├── result/                    # 结果封装
│           │   ├── Result.java            # 统一结果
│           │   ├── ResultCode.java        # 结果状态码
│           │   └── PageResult.java        # 分页结果
│           ├── util/                      # 工具类
│           │   ├── auth/                  # 认证工具
│           │   ├── crypto/                # 加密工具
│           │   │   ├── EncryptUtil.java   # 加密工具
│           │   │   └── DesensitizeUtil.java # 数据脱敏
│           │   ├── date/                  # 日期工具
│           │   ├── string/                # 字符串工具
│           │   └── device/                # 设备工具
│           │       └── DeviceUtil.java    # 设备工具
│           └── vo/                        # 视图对象
│
├── scripts/                               # 脚本文件目录（新增）
│   ├── build/                             # 构建脚本
│   │   ├── build-all.sh                   # 全项目构建
│   │   ├── build-server.sh                # 服务端构建
│   │   ├── build-client-backend.sh        # 客户端后端构建
│   │   └── build-client-frontend.sh       # 客户端前端构建
│   ├── deploy/                            # 部署脚本
│   │   ├── deploy-dev.sh                  # 开发环境部署
│   │   ├── deploy-prod.sh                 # 生产环境部署
│   │   └── rollback.sh                    # 回滚脚本
│   └── database/                          # 数据库脚本
│       ├── backup.sh                      # 备份脚本
│       └── restore.sh                     # 恢复脚本
│
└── tools/                                 # 开发工具目录（新增）
    ├── code-generator/                    # 代码生成器
    ├── api-doc/                           # API文档生成
    └── performance-test/                  # 性能测试工具
```

## 🔧 具体修改步骤

### 第一步：创建父项目POM文件
```xml
<!-- 在根目录创建 pom.xml -->
<project>
    <modelVersion>4.0.0</modelVersion>
    <groupId>org.example</groupId>
    <artifactId>sso-project-x</artifactId>
    <version>1.0.0</version>
    <packaging>pom</packaging>
    
    <modules>
        <module>sso-server</module>
        <module>sso-client-backend</module>
        <module>sso-common</module>
    </modules>
    
    <properties>
        <java.version>8</java.version>
        <spring-boot.version>2.7.0</spring-boot.version>
        <mybatis.version>2.2.2</mybatis.version>
        <sa-token.version>1.30.0</sa-token.version>
    </properties>
    
    <dependencyManagement>
        <!-- 统一管理依赖版本 -->
        <dependencies>
            <dependency>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-dependencies</artifactId>
                <version>${spring-boot.version}</version>
                <type>pom</type>
                <scope>import</scope>
            </dependency>
        </dependencies>
    </dependencyManagement>
</project>
```

### 第二步：优化模块内部结构
1. **sso-server（S端）**：
   - 按功能域组织控制器和服务
   - 专注于认证、用户管理、权限管理等核心功能
   - 移除业务逻辑，只保留系统管理功能

2. **sso-client-backend（C端后端）**：
   - 按功能域组织控制器和服务
   - 专注于业务逻辑处理
   - 通过API调用S端获取认证信息

3. **sso-client-frontend（C端前端）**：
   - 按功能域组织页面和组件
   - 统一组件命名和结构
   - 优化路由配置

### 第三步：创建共享资源目录
```bash
# 创建共享资源目录
mkdir -p shared/{db,config,docs}
mkdir -p shared/db/{schema,data,migrations}
mkdir -p shared/docs/{architecture,development,deployment,maintenance}

# 移动文件
mv db/* shared/db/schema/
mv docs/* shared/docs/
```

### 第四步：优化包结构
在每个模块内部，按功能域重新组织代码：
- `auth/` - 认证相关
- `user/` - 用户管理  
- `business/` - 业务功能
- `system/` - 系统管理

## 📋 重构检查清单

- [ ] 创建父项目POM文件
- [ ] 创建共享资源目录
- [ ] 优化各模块内部包结构
- [ ] 按功能域重新组织代码
- [ ] 统一命名规范
- [ ] 建立清晰的模块依赖关系
- [ ] 更新配置文件路径
- [ ] 修改导入语句
- [ ] 更新文档说明
- [ ] 测试重构后的功能

## ⚠️ 注意事项

1. **保持现有架构**：不改变S端、C端前后端的基本架构
2. **逐步优化**：建议分步骤进行，每步都要测试
3. **功能分离**：明确S端和C端的职责边界
4. **代码复用**：通过公共模块减少重复代码
5. **向后兼容**：确保重构后不影响现有功能

## 🎉 重构后的优势

1. **职责清晰**：S端专注认证，C端专注业务
2. **结构合理**：按功能域组织，便于维护和扩展
3. **依赖清晰**：模块间依赖关系明确，便于管理
4. **命名规范**：统一的命名约定，提高代码可读性
5. **配置集中**：统一的配置管理，避免配置不一致

## 🔄 与现有架构的对比

| 方面 | 重构前 | 重构后 |
|------|--------|--------|
| 模块职责 | 功能重叠，边界模糊 | 职责清晰，边界明确 |
| 代码组织 | 按技术层次组织 | 按功能域组织 |
| 依赖管理 | 分散管理，版本不一致 | 统一管理，版本一致 |
| 配置管理 | 各模块独立配置 | 统一配置，环境分离 |
| 文档管理 | 分散存放 | 集中管理，分类清晰 |

这个重构方案保持了您现有的S端、C端前后端架构，主要优化了内部结构和代码组织，提高了代码的可维护性和可扩展性。

