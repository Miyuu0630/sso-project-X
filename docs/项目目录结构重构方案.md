# SSO 项目目录结构重构方案

## 🎯 重构目标

1. **消除模块功能重复**：明确各模块职责边界
2. **优化目录组织**：按功能域重新组织代码结构
3. **统一命名规范**：建立一致的命名约定
4. **改进依赖管理**：建立清晰的模块依赖关系

## 🔄 重构后的目录结构

```
sso-project-X/
├── pom.xml                               # 父项目POM文件（新增）
├── README.md                             # 项目主说明文档
├── .gitignore                            # Git忽略文件
├── docker-compose.yml                    # Docker编排文件（新增）
│
├── shared/                               # 共享资源目录（重构）
│   ├── db/                              # 数据库相关文件
│   │   ├── schema/                      # 数据库表结构
│   │   │   ├── 01_sso_core.sql         # SSO核心表结构
│   │   │   ├── 02_business_tables.sql  # 业务表结构
│   │   │   └── 03_indexes.sql          # 索引创建脚本
│   │   ├── data/                        # 初始数据
│   │   │   ├── 01_system_data.sql      # 系统基础数据
│   │   │   └── 02_test_data.sql        # 测试数据
│   │   └── migrations/                  # 数据库迁移脚本
│   │       └── README.md                # 迁移说明文档
│   │
│   ├── config/                          # 统一配置文件（新增）
│   │   ├── application-common.yml       # 公共配置
│   │   ├── application-dev.yml          # 开发环境配置
│   │   ├── application-prod.yml         # 生产环境配置
│   │   └── logback-spring.xml           # 统一日志配置
│   │
│   └── docs/                            # 项目文档（重构）
│       ├── architecture/                # 架构设计文档
│       │   ├── system-overview.md       # 系统概览
│       │   ├── module-design.md         # 模块设计
│       │   └── api-design.md            # API设计规范
│       ├── development/                  # 开发指南
│       │   ├── setup-guide.md           # 环境搭建指南
│       │   ├── coding-standards.md      # 编码规范
│       │   └── testing-guide.md         # 测试指南
│       ├── deployment/                   # 部署文档
│       │   ├── docker-deploy.md         # Docker部署
│       │   ├── kubernetes-deploy.md     # K8s部署
│       │   └── manual-deploy.md         # 手动部署
│       └── maintenance/                  # 运维文档
│           ├── monitoring.md             # 监控指南
│           ├── troubleshooting.md        # 故障排除
│           └── upgrade-guide.md          # 升级指南
│
├── sso-core/                             # SSO核心服务（重构自sso-server）
│   ├── pom.xml                          # 模块POM文件
│   ├── README.md                         # 模块说明文档
│   └── src/
│       ├── main/
│       │   ├── java/org/example/sso/
│       │   │   ├── SsoCoreApplication.java # 主启动类
│       │   │   ├── config/               # 配置类
│       │   │   │   ├── SecurityConfig.java # 安全配置
│       │   │   │   ├── RedisConfig.java    # Redis配置
│       │   │   │   ├── SaTokenConfig.java  # Sa-Token配置
│       │   │   │   └── WebConfig.java      # Web配置
│       │   │   ├── controller/            # 控制器
│       │   │   │   ├── AuthController.java # 认证控制器
│       │   │   │   ├── SsoController.java  # SSO核心控制器
│       │   │   │   └── HealthController.java # 健康检查
│       │   │   ├── service/               # 服务层
│       │   │   │   ├── auth/              # 认证服务
│       │   │   │   │   ├── AuthService.java
│       │   │   │   │   └── impl/
│       │   │   │   ├── user/              # 用户服务
│       │   │   │   │   ├── UserService.java
│       │   │   │   │   └── impl/
│       │   │   │   └── permission/        # 权限服务
│       │   │   │       ├── PermissionService.java
│       │   │   │       └── impl/
│       │   │   ├── repository/            # 数据访问层（重构自mapper）
│       │   │   │   ├── entity/            # 实体类
│       │   │   │   ├── repository/        # 数据访问接口
│       │   │   │   └── mapper/            # MyBatis映射器
│       │   │   ├── dto/                   # 数据传输对象
│       │   │   ├── exception/             # 异常处理
│       │   │   └── util/                  # 工具类
│       │   └── resources/
│       │       ├── application.yml        # 模块配置
│       │       ├── mapper/                # MyBatis映射文件
│       │       └── static/                # 静态资源
│       └── test/
│           └── java/org/example/sso/
│               ├── controller/            # 控制器测试
│               ├── service/               # 服务层测试
│               └── integration/           # 集成测试
│
├── business-portal/                       # 业务门户（重构自sso-client-backend）
│   ├── pom.xml                           # 模块POM文件
│   ├── README.md                          # 模块说明文档
│   └── src/
│       ├── main/
│       │   ├── java/org/example/portal/
│       │   │   ├── PortalApplication.java # 主启动类
│       │   │   ├── config/                # 配置类
│       │   │   ├── controller/            # 控制器
│       │   │   │   ├── dashboard/         # 仪表板控制器
│       │   │   │   ├── user/              # 用户管理控制器
│       │   │   │   ├── business/          # 业务功能控制器
│       │   │   │   │   ├── airline/       # 航空业务
│       │   │   │   │   └── enterprise/    # 企业业务
│       │   │   │   └── system/            # 系统管理控制器
│       │   │   ├── service/               # 服务层
│       │   │   │   ├── dashboard/         # 仪表板服务
│       │   │   │   ├── user/              # 用户管理服务
│       │   │   │   ├── business/          # 业务服务
│       │   │   │   └── system/            # 系统管理服务
│       │   │   ├── repository/            # 数据访问层
│       │   │   ├── dto/                   # 数据传输对象
│       │   │   └── integration/           # 外部服务集成
│       │   │       └── sso/               # SSO集成
│       │   └── resources/
│       │       ├── application.yml        # 模块配置
│       │       └── mapper/                # MyBatis映射文件
│       └── test/
│           └── java/org/example/portal/
│
├── admin-console/                         # 管理控制台（重构自sso-client-frontend）
│   ├── package.json                       # 依赖配置
│   ├── vite.config.js                     # Vite配置
│   ├── README.md                          # 模块说明文档
│   └── src/
│       ├── main.js                        # 应用入口
│       ├── App.vue                        # 根组件
│       ├── router/                        # 路由配置
│       │   ├── index.js                   # 路由主文件
│       │   ├── auth.js                    # 认证路由
│       │   ├── dashboard.js               # 仪表板路由
│       │   ├── system.js                  # 系统管理路由
│       │   └── business.js                # 业务功能路由
│       ├── stores/                        # 状态管理
│       │   ├── auth.js                    # 认证状态
│       │   ├── user.js                    # 用户状态
│       │   └── app.js                     # 应用状态
│       ├── components/                    # 公共组件
│       │   ├── common/                    # 通用组件
│       │   ├── layout/                    # 布局组件
│       │   └── business/                  # 业务组件
│       ├── views/                         # 页面视图（重构）
│       │   ├── auth/                      # 认证页面
│       │   │   ├── Login.vue              # 登录页面
│       │   │   ├── Callback.vue           # 回调处理
│       │   │   └── Logout.vue             # 登出页面
│       │   ├── dashboard/                 # 仪表板页面
│       │   │   ├── MainDashboard.vue      # 主仪表板
│       │   │   ├── AdminDashboard.vue     # 管理员仪表板
│       │   │   ├── UserDashboard.vue      # 用户仪表板
│       │   │   └── BusinessDashboard.vue  # 业务仪表板
│       │   ├── system/                    # 系统管理页面
│       │   │   ├── user/                  # 用户管理
│       │   │   ├── role/                  # 角色管理
│       │   │   ├── menu/                  # 菜单管理
│       │   │   └── log/                   # 日志管理
│       │   ├── business/                  # 业务功能页面
│       │   │   ├── airline/               # 航空业务
│       │   │   │   ├── Flight.vue         # 航班管理
│       │   │   │   ├── Passenger.vue      # 乘客管理
│       │   │   │   └── Info.vue           # 公司信息
│       │   │   └── enterprise/            # 企业业务
│       │   │       ├── Auth.vue           # 企业认证
│       │   │       ├── Member.vue         # 成员管理
│       │   │       └── Info.vue           # 企业信息
│       │   └── monitor/                   # 监控页面
│       │       ├── LoginLog.vue           # 登录日志
│       │       ├── Online.vue             # 在线用户
│       │       └── Server.vue             # 服务器监控
│       ├── api/                           # API接口
│       │   ├── auth.js                    # 认证接口
│       │   ├── user.js                    # 用户接口
│       │   ├── system.js                  # 系统接口
│       │   └── business.js                # 业务接口
│       ├── utils/                         # 工具函数
│       │   ├── request.js                 # HTTP请求
│       │   ├── auth.js                    # 认证工具
│       │   └── common.js                  # 通用工具
│       └── config/                        # 配置文件
│           ├── sso.js                     # SSO配置
│           └── app.js                     # 应用配置
│
├── sso-common/                            # 公共模块（优化）
│   ├── pom.xml                            # 模块POM文件
│   ├── README.md                           # 模块说明文档
│   └── src/
│       └── main/java/org/example/common/
│           ├── annotation/                # 注解定义
│           ├── config/                    # 配置类
│           ├── constant/                  # 常量定义（统一命名）
│           │   ├── CommonConstants.java   # 通用常量
│           │   ├── SecurityConstants.java # 安全常量
│           │   └── BusinessConstants.java # 业务常量
│           ├── dto/                       # 数据传输对象
│           │   ├── base/                  # 基础DTO
│           │   │   ├── BaseRequest.java   # 基础请求
│           │   │   └── BaseResponse.java  # 基础响应
│           │   ├── auth/                  # 认证相关DTO
│           │   ├── user/                  # 用户相关DTO
│           │   └── business/              # 业务相关DTO
│           ├── entity/                    # 实体类
│           │   └── base/                  # 基础实体
│           ├── enums/                     # 枚举定义
│           │   ├── common/                # 通用枚举
│           │   ├── auth/                  # 认证枚举
│           │   └── business/              # 业务枚举
│           ├── exception/                 # 异常处理
│           │   ├── base/                  # 基础异常
│           │   ├── business/              # 业务异常
│           │   └── system/                # 系统异常
│           ├── interceptor/               # 拦截器
│           ├── mapper/                    # 数据映射器
│           ├── model/                     # 数据模型
│           │   ├── base/                  # 基础模型
│           │   ├── auth/                  # 认证模型
│           │   └── business/              # 业务模型
│           ├── result/                    # 结果封装
│           │   ├── Result.java            # 统一结果
│           │   ├── ResultCode.java        # 结果状态码
│           │   └── PageResult.java        # 分页结果
│           ├── util/                      # 工具类
│           │   ├── auth/                  # 认证工具
│           │   ├── crypto/                # 加密工具
│           │   ├── date/                  # 日期工具
│           │   └── string/                # 字符串工具
│           └── vo/                        # 视图对象
│
├── scripts/                               # 脚本文件目录（新增）
│   ├── build/                             # 构建脚本
│   │   ├── build-all.sh                   # 全项目构建
│   │   ├── build-backend.sh               # 后端构建
│   │   └── build-frontend.sh              # 前端构建
│   ├── deploy/                            # 部署脚本
│   │   ├── deploy-dev.sh                  # 开发环境部署
│   │   ├── deploy-prod.sh                 # 生产环境部署
│   │   └── rollback.sh                    # 回滚脚本
│   └── database/                          # 数据库脚本
│       ├── backup.sh                      # 备份脚本
│       └── restore.sh                     # 恢复脚本
│
└── tools/                                 # 开发工具目录（新增）
    ├── code-generator/                    # 代码生成器
    ├── api-doc/                           # API文档生成
    └── performance-test/                  # 性能测试工具
```

## 🔧 具体修改步骤

### 第一步：创建父项目POM文件
```xml
<!-- 在根目录创建 pom.xml -->
<project>
    <modelVersion>4.0.0</modelVersion>
    <groupId>org.example</groupId>
    <artifactId>sso-project-x</artifactId>
    <version>1.0.0</version>
    <packaging>pom</packaging>
    
    <modules>
        <module>sso-core</module>
        <module>business-portal</module>
        <module>sso-common</module>
    </modules>
    
    <properties>
        <java.version>8</java.version>
        <spring-boot.version>2.7.0</spring-boot.version>
        <mybatis.version>2.2.2</mybatis.version>
    </properties>
    
    <dependencyManagement>
        <!-- 统一管理依赖版本 -->
    </dependencyManagement>
</project>
```

### 第二步：重构模块结构
1. **重命名目录**：
   - `sso-server` → `sso-core`
   - `sso-client-backend` → `business-portal`
   - `sso-client-frontend` → `admin-console`

2. **移动文件**：
   - 将数据库脚本移动到 `shared/db/`
   - 将配置文件移动到 `shared/config/`
   - 将文档移动到 `shared/docs/`

### 第三步：优化包结构
1. **按功能域组织**：
   - `auth/` - 认证相关
   - `user/` - 用户管理
   - `business/` - 业务功能
   - `system/` - 系统管理

2. **统一命名规范**：
   - 移除重复的 `constants` 目录
   - 统一使用 `repository` 替代 `mapper`
   - 规范化包名和类名

### 第四步：建立依赖关系
```
sso-core (核心服务)
├── sso-common (公共模块)
└── 外部依赖 (Redis, MySQL)

business-portal (业务门户)
├── sso-common (公共模块)
└── sso-core (通过API调用)

admin-console (管理控制台)
└── 通过API调用后端服务
```

## 📋 重构检查清单

- [ ] 创建父项目POM文件
- [ ] 重命名主要模块目录
- [ ] 移动共享资源到shared目录
- [ ] 重构包结构，按功能域组织
- [ ] 统一命名规范
- [ ] 建立清晰的模块依赖关系
- [ ] 更新配置文件路径
- [ ] 修改导入语句
- [ ] 更新文档说明
- [ ] 测试重构后的功能

## ⚠️ 注意事项

1. **备份代码**：重构前务必备份整个项目
2. **逐步重构**：建议分步骤进行，每步都要测试
3. **更新配置**：修改后需要更新所有相关的配置文件路径
4. **测试验证**：重构完成后要全面测试功能是否正常
5. **团队协作**：重构期间需要团队协调，避免代码冲突

## 🎉 重构后的优势

1. **职责清晰**：每个模块职责明确，无功能重复
2. **结构合理**：按功能域组织，便于维护和扩展
3. **依赖清晰**：模块间依赖关系明确，便于管理
4. **命名规范**：统一的命名约定，提高代码可读性
5. **配置集中**：统一的配置管理，避免配置不一致

这个重构方案将显著改善项目的可维护性和可扩展性，建议按照步骤逐步实施。
