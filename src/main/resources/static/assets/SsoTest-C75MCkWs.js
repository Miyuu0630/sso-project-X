import{_ as M,u as F,i as m,c as _,m as G,a as T,o as b,b as s,w as o,d as n,r as i,f as a,t as d,G as H,H as j,E as u,z as q}from"./main-0j-tL-il.js";const J={class:"sso-test"},K={class:"card-header"},P={class:"test-content"},Q={class:"config-info"},R={class:"test-actions"},W={class:"test-logs"},X={class:"log-container"},Y={class:"log-time"},Z={class:"log-message"},ee={__name:"SsoTest",setup(se){const r=F(),v=m([]),h=m(window.location.origin),w=m("http://localhost:8082"),g=m("http://localhost:8081"),k=_(()=>r.token),S=_(()=>r.isLoggedIn),C=_(()=>S.value?"已登录":"未登录"),L=_(()=>S.value?"success":"warning"),$=_(()=>{var l;return S.value?`用户: ${((l=r.userInfo)==null?void 0:l.username)||"未知"}`:"请先进行SSO登录测试"}),t=(l,e="info")=>{v.value.unshift({id:Date.now(),time:new Date().toLocaleTimeString(),message:l,type:e})},x=()=>{t("刷新状态","info"),r.initAuth()},O=()=>{t("开始SSO登录测试","info"),t(`跳转到: ${g.value}/sso/auth`,"info"),r.redirectToLogin()},V=async()=>{try{t("开始验证Token","info"),await r.checkTokenValidity()?(t("Token验证成功","success"),u.success("Token有效")):(t("Token验证失败","error"),u.error("Token无效"))}catch(l){t(`Token验证异常: ${l.message}`,"error"),u.error("Token验证失败")}},I=async()=>{try{t("开始获取用户信息","info"),await r.fetchUserInfo(),t("用户信息获取成功","success"),u.success("用户信息获取成功")}catch(l){t(`用户信息获取失败: ${l.message}`,"error"),u.error("用户信息获取失败")}},U=()=>{t("清除认证信息","warning"),r.clearAuth(),u.success("认证信息已清除")},A=()=>{v.value=[]};return G(()=>{t("SSO测试页面已加载","info"),t(`前端地址: ${h.value}`,"info"),t(`后端地址: ${w.value}`,"info"),t(`SSO服务端: ${g.value}`,"info")}),(l,e)=>{const c=i("el-button"),D=i("el-alert"),y=i("el-divider"),p=i("el-descriptions-item"),z=i("el-descriptions"),B=i("el-space"),E=i("el-scrollbar"),N=i("el-card");return b(),T("div",J,[s(N,{class:"test-card"},{header:o(()=>[n("div",K,[e[1]||(e[1]=n("span",null,"SSO 连接测试",-1)),s(c,{type:"primary",onClick:x},{default:o(()=>e[0]||(e[0]=[a("刷新状态",-1)])),_:1,__:[0]})])]),default:o(()=>[n("div",P,[s(D,{title:C.value,type:L.value,description:$.value,"show-icon":"",closable:!1},null,8,["title","type","description"]),s(y),n("div",Q,[e[2]||(e[2]=n("h3",null,"配置信息",-1)),s(z,{column:2,border:""},{default:o(()=>[s(p,{label:"前端地址"},{default:o(()=>[a(d(h.value),1)]),_:1}),s(p,{label:"后端地址"},{default:o(()=>[a(d(w.value),1)]),_:1}),s(p,{label:"SSO服务端"},{default:o(()=>[a(d(g.value),1)]),_:1}),s(p,{label:"当前Token"},{default:o(()=>[a(d(k.value||"无"),1)]),_:1})]),_:1})]),s(y),n("div",R,[e[7]||(e[7]=n("h3",null,"测试操作",-1)),s(B,{wrap:""},{default:o(()=>[s(c,{type:"primary",onClick:O},{default:o(()=>e[3]||(e[3]=[a(" 测试SSO登录 ",-1)])),_:1,__:[3]}),s(c,{type:"success",onClick:V,disabled:!k.value},{default:o(()=>e[4]||(e[4]=[a(" 验证Token ",-1)])),_:1,__:[4]},8,["disabled"]),s(c,{type:"info",onClick:I,disabled:!k.value},{default:o(()=>e[5]||(e[5]=[a(" 获取用户信息 ",-1)])),_:1,__:[5]},8,["disabled"]),s(c,{type:"warning",onClick:U},{default:o(()=>e[6]||(e[6]=[a(" 清除认证 ",-1)])),_:1,__:[6]})]),_:1})]),s(y),n("div",W,[e[9]||(e[9]=n("h3",null,"测试日志",-1)),s(E,{height:"300px"},{default:o(()=>[n("div",X,[(b(!0),T(H,null,j(v.value,f=>(b(),T("div",{key:f.id,class:q(["log-item",`log-${f.type}`])},[n("span",Y,d(f.time),1),n("span",Z,d(f.message),1)],2))),128))])]),_:1}),s(c,{type:"danger",size:"small",onClick:A,style:{"margin-top":"10px"}},{default:o(()=>e[8]||(e[8]=[a(" 清空日志 ",-1)])),_:1,__:[8]})])])]),_:1})])}}},oe=M(ee,[["__scopeId","data-v-c79eeaa0"]]);export{oe as default};
