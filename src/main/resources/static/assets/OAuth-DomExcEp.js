import{_ as P,i as A,m as S,a as d,o as i,b as n,w as s,d as e,r as c,G as $,H as C,e as u,N as D,a1 as O,x as Q,f,$ as V,a3 as q,a0 as k,n as h,p as I,t as r,B as R,a4 as F,a5 as L,a2 as x,E as p}from"./main-0j-tL-il.js";const T={class:"oauth-container"},j={class:"card-header"},J={class:"oauth-content"},K={class:"oauth-description"},U={class:"oauth-providers"},W={class:"provider-info"},X={class:"provider-icon"},Y={class:"provider-details"},Z={key:0,class:"bound-info"},tt={class:"bound-account"},et={key:1,class:"unbound-info"},nt={class:"provider-actions"},ot={class:"card-header"},st={class:"history-content"},at={class:"history-ip"},lt={key:0,class:"empty-history"},it={class:"card-header"},ct={class:"security-tips"},dt={__name:"OAuth",setup(ut){const m=A([{type:"wechat",name:"微信",description:"使用微信账号快速登录",icon:"ChatDotRound",color:"#07c160",bound:!1,boundAccount:"",loading:!1},{type:"qq",name:"QQ",description:"使用QQ账号快速登录",icon:"ChatRound",color:"#12b7f5",bound:!1,boundAccount:"",loading:!1},{type:"weibo",name:"微博",description:"使用微博账号快速登录",icon:"Share",color:"#e6162d",bound:!1,boundAccount:"",loading:!1},{type:"github",name:"GitHub",description:"使用GitHub账号快速登录",icon:"Platform",color:"#24292e",bound:!1,boundAccount:"",loading:!1},{type:"google",name:"Google",description:"使用Google账号快速登录",icon:"Search",color:"#4285f4",bound:!1,boundAccount:"",loading:!1},{type:"dingtalk",name:"钉钉",description:"使用钉钉账号快速登录",icon:"Message",color:"#0089ff",bound:!1,boundAccount:"",loading:!1}]),b=A([]),B=async l=>{const t=m.value.find(o=>o.type===l);if(t)try{t.loading=!0,await x.confirm(`确定要绑定${t.name}账号吗？这将打开新窗口进行授权。`,"确认绑定",{type:"info"}),setTimeout(()=>{t.bound=!0,t.boundAccount=`${t.name}用户_${Math.random().toString(36).substr(2,8)}`,p.success(`${t.name}账号绑定成功`),y()},2e3)}catch(o){o!=="cancel"&&p.error(`${t.name}账号绑定失败`)}finally{t.loading=!1}},N=async l=>{const t=m.value.find(o=>o.type===l);if(t)try{await x.confirm(`确定要解绑${t.name}账号吗？解绑后将无法使用该账号登录。`,"确认解绑",{type:"warning"}),t.loading=!0;const o=await k.delete(`/api/oauth/${l}/unbind`);o.data.code===200?(t.bound=!1,t.boundAccount="",p.success(`${t.name}账号解绑成功`),y()):p.error(o.data.message||`${t.name}账号解绑失败`)}catch(o){o!=="cancel"&&p.error(`${t.name}账号解绑失败`)}finally{t.loading=!1}},z=async()=>{try{const l=await k.get("/api/oauth/status");if(l.data.code===200){const t=l.data.data||{};m.value.forEach(o=>{const _=t[o.type];_&&(o.bound=_.bound,o.boundAccount=_.account||"")})}}catch(l){console.error("获取OAuth状态失败:",l)}},y=async()=>{try{const l=await k.get("/api/oauth/history");l.data.code===200&&(b.value=l.data.data||[])}catch(l){console.error("获取绑定记录失败:",l)}};return S(()=>{z(),y()}),(l,t)=>{const o=c("el-icon"),_=c("el-alert"),w=c("el-tag"),g=c("el-button"),v=c("el-card"),E=c("el-timeline-item"),G=c("el-timeline"),H=c("el-empty");return i(),d("div",T,[n(v,{class:"oauth-card"},{header:s(()=>[e("div",j,[n(o,null,{default:s(()=>[n(u(D))]),_:1}),t[0]||(t[0]=e("span",null,"第三方账号绑定",-1))])]),default:s(()=>[e("div",J,[e("div",K,[n(_,{title:"第三方账号绑定",description:"绑定第三方账号后，您可以使用这些账号快速登录系统，提升使用体验。",type:"info",closable:!1,"show-icon":""})]),e("div",U,[(i(!0),d($,null,C(m.value,a=>(i(),d("div",{key:a.type,class:"provider-item"},[e("div",W,[e("div",X,[n(o,{size:32,color:a.color},{default:s(()=>[(i(),h(I(a.icon)))]),_:2},1032,["color"])]),e("div",Y,[e("h4",null,r(a.name),1),e("p",null,r(a.description),1),a.bound?(i(),d("div",Z,[n(w,{type:"success",size:"small"},{default:s(()=>[n(o,null,{default:s(()=>[n(u(R))]),_:1}),t[1]||(t[1]=f(" 已绑定 ",-1))]),_:1,__:[1]}),e("span",tt,r(a.boundAccount),1)])):(i(),d("div",et,[n(w,{type:"info",size:"small"},{default:s(()=>t[2]||(t[2]=[f("未绑定",-1)])),_:1,__:[2]})]))])]),e("div",nt,[a.bound?(i(),h(g,{key:1,type:"danger",onClick:M=>N(a.type),loading:a.loading},{default:s(()=>[n(o,null,{default:s(()=>[n(u(L))]),_:1}),t[4]||(t[4]=f(" 解绑 ",-1))]),_:2,__:[4]},1032,["onClick","loading"])):(i(),h(g,{key:0,type:"primary",onClick:M=>B(a.type),loading:a.loading},{default:s(()=>[n(o,null,{default:s(()=>[n(u(F))]),_:1}),t[3]||(t[3]=f(" 绑定 ",-1))]),_:2,__:[3]},1032,["onClick","loading"]))])]))),128))])])]),_:1}),n(v,{class:"history-card"},{header:s(()=>[e("div",ot,[n(o,null,{default:s(()=>[n(u(Q))]),_:1}),t[6]||(t[6]=e("span",null,"绑定记录",-1)),n(g,{type:"text",size:"small",onClick:y,style:{"margin-left":"auto"}},{default:s(()=>[n(o,null,{default:s(()=>[n(u(V))]),_:1}),t[5]||(t[5]=f(" 刷新 ",-1))]),_:1,__:[5]})])]),default:s(()=>[n(G,null,{default:s(()=>[(i(!0),d($,null,C(b.value,a=>(i(),h(E,{key:a.id,timestamp:a.time,type:a.type==="bind"?"success":"warning"},{default:s(()=>[e("div",st,[e("h4",null,r(a.type==="bind"?"绑定":"解绑")+" "+r(a.providerName),1),e("p",null,r(a.description),1),e("span",at,"IP: "+r(a.ipAddress),1)])]),_:2},1032,["timestamp","type"]))),128))]),_:1}),b.value.length===0?(i(),d("div",lt,[n(H,{description:"暂无绑定记录","image-size":80})])):O("",!0)]),_:1}),n(v,{class:"tips-card"},{header:s(()=>[e("div",it,[n(o,null,{default:s(()=>[n(u(q))]),_:1}),t[7]||(t[7]=e("span",null,"安全提示",-1))])]),default:s(()=>[e("div",ct,[n(_,{title:"安全建议",type:"warning",closable:!1,"show-icon":""},{default:s(()=>t[8]||(t[8]=[e("ul",{class:"tips-list"},[e("li",null,"请确保您的第三方账号安全，避免被他人恶意使用"),e("li",null,"如果发现异常登录，请及时解绑相关账号并修改密码"),e("li",null,"建议定期检查绑定的第三方账号，及时清理不需要的绑定"),e("li",null,"绑定的第三方账号仅用于登录验证，不会获取您的隐私信息")],-1)])),_:1,__:[8]})])]),_:1})])}}},_t=P(dt,[["__scopeId","data-v-6ba00e89"]]);export{_t as default};
