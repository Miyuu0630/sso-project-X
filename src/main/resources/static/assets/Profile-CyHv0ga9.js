import{_ as G,u as H,i as h,Y,c as Z,m as J,a as D,o as I,b as e,w as a,d,r,f as n,t as p,e as g,Z as K,B as Q,$ as W,h as X,G as ee,H as ae,A as le,E as y,a0 as te,n as oe}from"./main-0j-tL-il.js";const se={class:"profile-container"},re={class:"card-header"},ne={class:"profile-content"},ue={class:"avatar-section"},de={class:"avatar-actions"},ie={class:"card-header"},_e={class:"roles-permissions"},pe={class:"roles"},me={class:"permissions"},fe={__name:"Profile",setup(ce){const b=H(),S=h(),R=h(!1),o=Y({username:"",realName:"",phone:"",email:"",gender:0,avatar:"",remark:""}),L={realName:[{required:!0,message:"请输入真实姓名",trigger:"blur"}],phone:[{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号",trigger:"blur"}],email:[{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}]},s=Z(()=>b.userInfo),w={ADMIN:"系统管理员",AIRLINE_USER:"航司用户",ENTERPRISE_USER:"企业用户",PERSONAL_USER:"个人用户"},M=()=>w[b.primaryRole]||"未知角色",T=()=>({ADMIN:"danger",AIRLINE_USER:"warning",ENTERPRISE_USER:"success",PERSONAL_USER:"info"})[b.primaryRole]||"info",C=u=>w[u]||u,A=u=>u?new Date(u).toLocaleString("zh-CN"):"未知",V=()=>{s.value&&Object.assign(o,{username:s.value.username||"",realName:s.value.realName||"",phone:s.value.phone||"",email:s.value.email||"",gender:s.value.gender||0,avatar:s.value.avatar||"",remark:s.value.remark||""})},z=async()=>{try{await S.value.validate(),R.value=!0;const u=await te.put("/api/user/profile",o);u.data.code===200?(y.success("个人资料保存成功"),await b.fetchUserInfo(),V()):y.error(u.data.message||"保存失败")}catch(u){console.error("保存个人资料失败:",u),y.error("保存失败")}finally{R.value=!1}},B=()=>{V(),y.info("已重置为原始数据")},O=()=>{y.info("头像上传功能开发中...")};return J(()=>{V()}),(u,l)=>{const f=r("el-icon"),q=r("el-avatar"),E=r("el-button"),c=r("el-input"),_=r("el-form-item"),m=r("el-col"),k=r("el-row"),U=r("el-radio"),F=r("el-radio-group"),N=r("el-tag"),$=r("el-form"),x=r("el-card"),v=r("el-descriptions-item"),j=r("el-descriptions");return I(),D("div",se,[e(x,{class:"profile-card"},{header:a(()=>[d("div",re,[e(f,null,{default:a(()=>[e(g(X))]),_:1}),l[6]||(l[6]=d("span",null,"个人资料",-1))])]),default:a(()=>[d("div",ne,[d("div",ue,[e(q,{size:100,src:o.avatar},{default:a(()=>{var t,i;return[n(p(((t=o.realName)==null?void 0:t.charAt(0))||((i=o.username)==null?void 0:i.charAt(0))||"U"),1)]}),_:1},8,["src"]),d("div",de,[e(E,{type:"primary",size:"small",onClick:O},{default:a(()=>[e(f,null,{default:a(()=>[e(g(K))]),_:1}),l[7]||(l[7]=n(" 更换头像 ",-1))]),_:1,__:[7]})])]),e($,{ref_key:"formRef",ref:S,model:o,rules:L,"label-width":"100px",class:"profile-form"},{default:a(()=>[e(k,{gutter:20},{default:a(()=>[e(m,{span:12},{default:a(()=>[e(_,{label:"用户名",prop:"username"},{default:a(()=>[e(c,{modelValue:o.username,"onUpdate:modelValue":l[0]||(l[0]=t=>o.username=t),disabled:""},null,8,["modelValue"])]),_:1})]),_:1}),e(m,{span:12},{default:a(()=>[e(_,{label:"真实姓名",prop:"realName"},{default:a(()=>[e(c,{modelValue:o.realName,"onUpdate:modelValue":l[1]||(l[1]=t=>o.realName=t),placeholder:"请输入真实姓名"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(k,{gutter:20},{default:a(()=>[e(m,{span:12},{default:a(()=>[e(_,{label:"手机号",prop:"phone"},{default:a(()=>[e(c,{modelValue:o.phone,"onUpdate:modelValue":l[2]||(l[2]=t=>o.phone=t),placeholder:"请输入手机号"},null,8,["modelValue"])]),_:1})]),_:1}),e(m,{span:12},{default:a(()=>[e(_,{label:"邮箱",prop:"email"},{default:a(()=>[e(c,{modelValue:o.email,"onUpdate:modelValue":l[3]||(l[3]=t=>o.email=t),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(k,{gutter:20},{default:a(()=>[e(m,{span:12},{default:a(()=>[e(_,{label:"性别",prop:"gender"},{default:a(()=>[e(F,{modelValue:o.gender,"onUpdate:modelValue":l[4]||(l[4]=t=>o.gender=t)},{default:a(()=>[e(U,{value:0},{default:a(()=>l[8]||(l[8]=[n("未知",-1)])),_:1,__:[8]}),e(U,{value:1},{default:a(()=>l[9]||(l[9]=[n("男",-1)])),_:1,__:[9]}),e(U,{value:2},{default:a(()=>l[10]||(l[10]=[n("女",-1)])),_:1,__:[10]})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(m,{span:12},{default:a(()=>[e(_,{label:"用户类型"},{default:a(()=>[e(N,{type:T()},{default:a(()=>[n(p(M()),1)]),_:1},8,["type"])]),_:1})]),_:1})]),_:1}),e(_,{label:"个人简介",prop:"remark"},{default:a(()=>[e(c,{modelValue:o.remark,"onUpdate:modelValue":l[5]||(l[5]=t=>o.remark=t),type:"textarea",rows:4,placeholder:"请输入个人简介"},null,8,["modelValue"])]),_:1}),e(_,null,{default:a(()=>[e(E,{type:"primary",onClick:z,loading:R.value},{default:a(()=>[e(f,null,{default:a(()=>[e(g(Q))]),_:1}),l[11]||(l[11]=n(" 保存修改 ",-1))]),_:1,__:[11]},8,["loading"]),e(E,{onClick:B},{default:a(()=>[e(f,null,{default:a(()=>[e(g(W))]),_:1}),l[12]||(l[12]=n(" 重置 ",-1))]),_:1,__:[12]})]),_:1})]),_:1},8,["model"])])]),_:1}),e(x,{class:"info-card"},{header:a(()=>[d("div",ie,[e(f,null,{default:a(()=>[e(g(le))]),_:1}),l[13]||(l[13]=d("span",null,"账号信息",-1))])]),default:a(()=>[e(j,{column:2,border:""},{default:a(()=>[e(v,{label:"用户ID"},{default:a(()=>{var t;return[n(p((t=s.value)==null?void 0:t.id),1)]}),_:1}),e(v,{label:"账号状态"},{default:a(()=>{var t;return[e(N,{type:((t=s.value)==null?void 0:t.status)==="1"?"success":"danger"},{default:a(()=>{var i;return[n(p(((i=s.value)==null?void 0:i.status)==="1"?"正常":"禁用"),1)]}),_:1},8,["type"])]}),_:1}),e(v,{label:"注册时间"},{default:a(()=>{var t;return[n(p(A((t=s.value)==null?void 0:t.createTime)),1)]}),_:1}),e(v,{label:"最后登录"},{default:a(()=>{var t;return[n(p(A((t=s.value)==null?void 0:t.lastLoginTime)),1)]}),_:1}),e(v,{label:"角色权限",span:2},{default:a(()=>{var t;return[d("div",_e,[d("div",pe,[l[14]||(l[14]=d("span",{class:"label"},"角色：",-1)),(I(!0),D(ee,null,ae((t=s.value)==null?void 0:t.roles,i=>(I(),oe(N,{key:i,type:"info",size:"small",style:{"margin-right":"8px"}},{default:a(()=>[n(p(C(i)),1)]),_:2},1024))),128))]),d("div",me,[l[15]||(l[15]=d("span",{class:"label"},"权限数量：",-1)),e(N,{type:"success",size:"small"},{default:a(()=>{var i,P;return[n(p(((P=(i=s.value)==null?void 0:i.permissions)==null?void 0:P.length)||0)+" 个权限 ",1)]}),_:1})])])]}),_:1})]),_:1})]),_:1})])}}},ge=G(fe,[["__scopeId","data-v-9d88fad5"]]);export{ge as default};
