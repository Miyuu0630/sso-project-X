import{_ as ae,i as w,Y as z,m as le,a as te,o as $,b as e,w as l,d as U,ab as se,r,f as n,e as T,aa as oe,$ as re,ac as ne,n as E,t as M,h as ue,a4 as de,a1 as ie,E as m,a2 as q}from"./main-0j-tL-il.js";const pe={class:"user-management"},me={class:"card-header"},_e={class:"header-actions"},fe={class:"search-area"},ge={class:"pagination"},ce={__name:"User",setup(ve){const k=w(!1),C=w(!1),c=w(!1),v=w(null),x=w(),F=w([]),_=z({username:"",status:""}),d=z({page:1,size:10,total:0}),o=z({username:"",realName:"",phone:"",email:"",userType:"normal",status:"1",password:""}),O={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],realName:[{required:!0,message:"请输入真实姓名",trigger:"blur"}],phone:[{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号",trigger:"blur"}],email:[{type:"email",message:"请输入正确的邮箱",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度不能少于6位",trigger:"blur"}]},R=s=>({normal:"info",enterprise:"success",airline:"warning"})[s]||"info",I=s=>({normal:"个人用户",enterprise:"企业用户",airline:"航司用户"})[s]||"未知",f=async()=>{try{k.value=!0;const s={page:d.page,size:d.size,..._},a=await K(s);F.value=a.data.records,d.total=a.data.total}catch(s){console.error("加载用户列表失败:",s),m.error("加载用户列表失败")}finally{k.value=!1}},P=()=>{Object.assign(_,{username:"",status:""}),d.page=1,f()},A=s=>{v.value=s,Object.assign(o,{username:s.username,realName:s.realName,phone:s.phone,email:s.email,userType:s.userType,status:s.status,password:""}),c.value=!0},G=async()=>{try{await x.value.validate(),C.value=!0,v.value?m.success("用户信息更新成功"):m.success("用户创建成功"),c.value=!1,J(),f()}catch(s){console.error("保存用户失败:",s),m.error("保存用户失败")}finally{C.value=!1}},Y=async s=>{try{const a=s.status==="1"?"禁用":"启用";await q.confirm(`确定要${a}用户 ${s.username} 吗？`,"确认操作"),s.status=s.status==="1"?"0":"1",m.success(`用户${a}成功`)}catch(a){a!=="cancel"&&(console.error("切换用户状态失败:",a),m.error("操作失败"))}},H=async s=>{try{await q.confirm(`确定要删除用户 ${s.username} 吗？`,"确认删除",{type:"warning"}),m.success("用户删除成功"),f()}catch(a){a!=="cancel"&&(console.error("删除用户失败:",a),m.error("删除用户失败"))}},J=()=>{var s;v.value=null,Object.assign(o,{username:"",realName:"",phone:"",email:"",userType:"normal",status:"1",password:""}),(s=x.value)==null||s.resetFields()},K=async s=>new Promise(a=>{setTimeout(()=>{const g=[{id:1,username:"admin",realName:"系统管理员",phone:"13800138000",email:"admin@example.com",userType:"normal",status:"1",createTime:"2024-01-01 10:00:00"},{id:2,username:"airline_user",realName:"航司用户",phone:"13800138001",email:"airline@example.com",userType:"airline",status:"1",createTime:"2024-01-02 10:00:00"}];a({data:{records:g,total:g.length}})},500)});return le(()=>{f()}),(s,a)=>{const g=r("el-icon"),p=r("el-button"),y=r("el-input"),u=r("el-form-item"),V=r("el-option"),B=r("el-select"),D=r("el-form"),i=r("el-table-column"),S=r("el-tag"),L=r("el-table"),Q=r("el-pagination"),W=r("el-card"),b=r("el-col"),N=r("el-row"),h=r("el-radio"),X=r("el-radio-group"),Z=r("el-dialog"),ee=ne("loading");return $(),te("div",pe,[e(W,null,{header:l(()=>[U("div",me,[e(g,null,{default:l(()=>[e(T(ue))]),_:1}),a[15]||(a[15]=U("span",null,"用户管理",-1)),U("div",_e,[e(p,{type:"primary",onClick:a[0]||(a[0]=t=>c.value=!0)},{default:l(()=>[e(g,null,{default:l(()=>[e(T(de))]),_:1}),a[14]||(a[14]=n(" 新增用户 ",-1))]),_:1,__:[14]})])])]),default:l(()=>[U("div",fe,[e(D,{model:_,inline:""},{default:l(()=>[e(u,{label:"用户名"},{default:l(()=>[e(y,{modelValue:_.username,"onUpdate:modelValue":a[1]||(a[1]=t=>_.username=t),placeholder:"请输入用户名",clearable:""},null,8,["modelValue"])]),_:1}),e(u,{label:"状态"},{default:l(()=>[e(B,{modelValue:_.status,"onUpdate:modelValue":a[2]||(a[2]=t=>_.status=t),placeholder:"请选择状态",clearable:""},{default:l(()=>[e(V,{label:"正常",value:"1"}),e(V,{label:"禁用",value:"0"})]),_:1},8,["modelValue"])]),_:1}),e(u,null,{default:l(()=>[e(p,{type:"primary",onClick:f},{default:l(()=>[e(g,null,{default:l(()=>[e(T(oe))]),_:1}),a[16]||(a[16]=n(" 搜索 ",-1))]),_:1,__:[16]}),e(p,{onClick:P},{default:l(()=>[e(g,null,{default:l(()=>[e(T(re))]),_:1}),a[17]||(a[17]=n(" 重置 ",-1))]),_:1,__:[17]})]),_:1})]),_:1},8,["model"])]),se(($(),E(L,{data:F.value,style:{width:"100%"}},{default:l(()=>[e(i,{prop:"id",label:"ID",width:"80"}),e(i,{prop:"username",label:"用户名",width:"120"}),e(i,{prop:"realName",label:"真实姓名",width:"120"}),e(i,{prop:"phone",label:"手机号",width:"130"}),e(i,{prop:"email",label:"邮箱",width:"180"}),e(i,{prop:"userType",label:"用户类型",width:"100"},{default:l(t=>[e(S,{type:R(t.row.userType)},{default:l(()=>[n(M(I(t.row.userType)),1)]),_:2},1032,["type"])]),_:1}),e(i,{prop:"status",label:"状态",width:"80"},{default:l(t=>[e(S,{type:t.row.status==="1"?"success":"danger"},{default:l(()=>[n(M(t.row.status==="1"?"正常":"禁用"),1)]),_:2},1032,["type"])]),_:1}),e(i,{prop:"createTime",label:"创建时间",width:"160"}),e(i,{label:"操作",width:"200",fixed:"right"},{default:l(t=>[e(p,{type:"primary",size:"small",onClick:j=>A(t.row)},{default:l(()=>a[18]||(a[18]=[n(" 编辑 ",-1)])),_:2,__:[18]},1032,["onClick"]),e(p,{type:t.row.status==="1"?"warning":"success",size:"small",onClick:j=>Y(t.row)},{default:l(()=>[n(M(t.row.status==="1"?"禁用":"启用"),1)]),_:2},1032,["type","onClick"]),e(p,{type:"danger",size:"small",onClick:j=>H(t.row)},{default:l(()=>a[19]||(a[19]=[n(" 删除 ",-1)])),_:2,__:[19]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[ee,k.value]]),U("div",ge,[e(Q,{"current-page":d.page,"onUpdate:currentPage":a[3]||(a[3]=t=>d.page=t),"page-size":d.size,"onUpdate:pageSize":a[4]||(a[4]=t=>d.size=t),"page-sizes":[10,20,50,100],total:d.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:f,onCurrentChange:f},null,8,["current-page","page-size","total"])])]),_:1}),e(Z,{modelValue:c.value,"onUpdate:modelValue":a[13]||(a[13]=t=>c.value=t),title:v.value?"编辑用户":"新增用户",width:"600px"},{footer:l(()=>[e(p,{onClick:a[12]||(a[12]=t=>c.value=!1)},{default:l(()=>a[22]||(a[22]=[n("取消",-1)])),_:1,__:[22]}),e(p,{type:"primary",onClick:G,loading:C.value},{default:l(()=>a[23]||(a[23]=[n(" 确定 ",-1)])),_:1,__:[23]},8,["loading"])]),default:l(()=>[e(D,{ref_key:"userFormRef",ref:x,model:o,rules:O,"label-width":"100px"},{default:l(()=>[e(N,{gutter:20},{default:l(()=>[e(b,{span:12},{default:l(()=>[e(u,{label:"用户名",prop:"username"},{default:l(()=>[e(y,{modelValue:o.username,"onUpdate:modelValue":a[5]||(a[5]=t=>o.username=t),disabled:v.value},null,8,["modelValue","disabled"])]),_:1})]),_:1}),e(b,{span:12},{default:l(()=>[e(u,{label:"真实姓名",prop:"realName"},{default:l(()=>[e(y,{modelValue:o.realName,"onUpdate:modelValue":a[6]||(a[6]=t=>o.realName=t)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(N,{gutter:20},{default:l(()=>[e(b,{span:12},{default:l(()=>[e(u,{label:"手机号",prop:"phone"},{default:l(()=>[e(y,{modelValue:o.phone,"onUpdate:modelValue":a[7]||(a[7]=t=>o.phone=t)},null,8,["modelValue"])]),_:1})]),_:1}),e(b,{span:12},{default:l(()=>[e(u,{label:"邮箱",prop:"email"},{default:l(()=>[e(y,{modelValue:o.email,"onUpdate:modelValue":a[8]||(a[8]=t=>o.email=t)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(N,{gutter:20},{default:l(()=>[e(b,{span:12},{default:l(()=>[e(u,{label:"用户类型",prop:"userType"},{default:l(()=>[e(B,{modelValue:o.userType,"onUpdate:modelValue":a[9]||(a[9]=t=>o.userType=t),style:{width:"100%"}},{default:l(()=>[e(V,{label:"个人用户",value:"normal"}),e(V,{label:"企业用户",value:"enterprise"}),e(V,{label:"航司用户",value:"airline"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(b,{span:12},{default:l(()=>[e(u,{label:"状态",prop:"status"},{default:l(()=>[e(X,{modelValue:o.status,"onUpdate:modelValue":a[10]||(a[10]=t=>o.status=t)},{default:l(()=>[e(h,{value:"1"},{default:l(()=>a[20]||(a[20]=[n("正常",-1)])),_:1,__:[20]}),e(h,{value:"0"},{default:l(()=>a[21]||(a[21]=[n("禁用",-1)])),_:1,__:[21]})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),v.value?ie("",!0):($(),E(u,{key:0,label:"密码",prop:"password"},{default:l(()=>[e(y,{modelValue:o.password,"onUpdate:modelValue":a[11]||(a[11]=t=>o.password=t),type:"password"},null,8,["modelValue"])]),_:1}))]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},be=ae(ce,[["__scopeId","data-v-2e286e8e"]]);export{be as default};
