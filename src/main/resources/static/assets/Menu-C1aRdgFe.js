import{_ as P,i as _,Y as Q,c as W,m as X,a as Z,o as v,b as e,w as t,ab as ee,ac as le,n as M,r as s,a1 as te,p as ne,f as r,t as $,d as U,e as B,C as oe,a4 as ae,E as f,a2 as se}from"./main-0j-tL-il.js";const re={class:"menu-management"},de={class:"card-header"},ie={class:"header-actions"},ue={__name:"Menu",setup(pe){const g=_(!1),b=_(!1),u=_(!1),c=_(null),h=_(),w=_([]),a=Q({name:"",path:"",icon:"",type:"menu",sort:0,hidden:!1,permission:"",parentId:null}),E={name:[{required:!0,message:"请输入菜单名称",trigger:"blur"}],path:[{required:!0,message:"请输入菜单路径",trigger:"blur"}]},N=W(()=>x(w.value)),x=o=>o.map(l=>({id:l.id,name:l.name,children:l.children?x(l.children):[]})),V=async()=>{try{g.value=!0,w.value=[{id:1,name:"系统管理",path:"/system",icon:"Setting",type:"menu",sort:1,hidden:!1,permission:"system:manage",children:[{id:11,name:"用户管理",path:"/system/user",icon:"User",type:"menu",sort:1,hidden:!1,permission:"system:user:list"},{id:12,name:"角色管理",path:"/system/role",icon:"UserFilled",type:"menu",sort:2,hidden:!1,permission:"system:role:list"}]},{id:2,name:"系统监控",path:"/monitor",icon:"Monitor",type:"menu",sort:2,hidden:!1,permission:"monitor:manage",children:[{id:21,name:"在线用户",path:"/monitor/online",icon:"UserFilled",type:"menu",sort:1,hidden:!1,permission:"monitor:online"}]}]}catch(o){console.error("加载菜单列表失败:",o),f.error("加载菜单列表失败")}finally{g.value=!1}},j=o=>{c.value=o,Object.assign(a,{name:o.name,path:o.path,icon:o.icon,type:o.type,sort:o.sort,hidden:o.hidden,permission:o.permission,parentId:o.parentId}),u.value=!0},z=o=>{c.value=null,Object.assign(a,{name:"",path:"",icon:"",type:"menu",sort:0,hidden:!1,permission:"",parentId:o.id}),u.value=!0},O=async()=>{try{await h.value.validate(),b.value=!0,c.value?f.success("菜单更新成功"):f.success("菜单创建成功"),u.value=!1,T(),V()}catch(o){console.error("保存菜单失败:",o),f.error("保存菜单失败")}finally{b.value=!1}},R=async o=>{try{await se.confirm(`确定要删除菜单 ${o.name} 吗？`,"确认删除",{type:"warning"}),f.success("菜单删除成功"),V()}catch(l){l!=="cancel"&&(console.error("删除菜单失败:",l),f.error("删除菜单失败"))}},T=()=>{var o;c.value=null,Object.assign(a,{name:"",path:"",icon:"",type:"menu",sort:0,hidden:!1,permission:"",parentId:null}),(o=h.value)==null||o.resetFields()};return X(()=>{V()}),(o,l)=>{const C=s("el-icon"),p=s("el-button"),d=s("el-table-column"),I=s("el-tag"),q=s("el-table"),S=s("el-card"),y=s("el-input"),i=s("el-form-item"),m=s("el-col"),k=s("el-row"),D=s("el-radio"),A=s("el-radio-group"),Y=s("el-input-number"),G=s("el-switch"),H=s("el-tree-select"),J=s("el-form"),K=s("el-dialog"),L=le("loading");return v(),Z("div",re,[e(S,null,{header:t(()=>[U("div",de,[e(C,null,{default:t(()=>[e(B(oe))]),_:1}),l[12]||(l[12]=U("span",null,"菜单管理",-1)),U("div",ie,[e(p,{type:"primary",onClick:l[0]||(l[0]=n=>u.value=!0)},{default:t(()=>[e(C,null,{default:t(()=>[e(B(ae))]),_:1}),l[11]||(l[11]=r(" 新增菜单 ",-1))]),_:1,__:[11]})])])]),default:t(()=>[ee((v(),M(q,{data:w.value,style:{width:"100%"},"row-key":"id","tree-props":{children:"children",hasChildren:"hasChildren"}},{default:t(()=>[e(d,{prop:"name",label:"菜单名称",width:"200"}),e(d,{prop:"path",label:"路径",width:"200"}),e(d,{prop:"icon",label:"图标",width:"100"},{default:t(n=>[n.row.icon?(v(),M(C,{key:0},{default:t(()=>[(v(),M(ne(n.row.icon)))]),_:2},1024)):te("",!0)]),_:1}),e(d,{prop:"type",label:"类型",width:"100"},{default:t(n=>[e(I,{type:n.row.type==="menu"?"primary":"info"},{default:t(()=>[r($(n.row.type==="menu"?"菜单":"按钮"),1)]),_:2},1032,["type"])]),_:1}),e(d,{prop:"sort",label:"排序",width:"80"}),e(d,{prop:"hidden",label:"隐藏",width:"80"},{default:t(n=>[e(I,{type:n.row.hidden?"warning":"success"},{default:t(()=>[r($(n.row.hidden?"是":"否"),1)]),_:2},1032,["type"])]),_:1}),e(d,{prop:"permission",label:"权限标识"}),e(d,{label:"操作",width:"200",fixed:"right"},{default:t(n=>[e(p,{type:"primary",size:"small",onClick:F=>j(n.row)},{default:t(()=>l[13]||(l[13]=[r(" 编辑 ",-1)])),_:2,__:[13]},1032,["onClick"]),e(p,{type:"success",size:"small",onClick:F=>z(n.row)},{default:t(()=>l[14]||(l[14]=[r(" 新增子菜单 ",-1)])),_:2,__:[14]},1032,["onClick"]),e(p,{type:"danger",size:"small",onClick:F=>R(n.row)},{default:t(()=>l[15]||(l[15]=[r(" 删除 ",-1)])),_:2,__:[15]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[L,g.value]])]),_:1}),e(K,{modelValue:u.value,"onUpdate:modelValue":l[10]||(l[10]=n=>u.value=n),title:c.value?"编辑菜单":"新增菜单",width:"600px"},{footer:t(()=>[e(p,{onClick:l[9]||(l[9]=n=>u.value=!1)},{default:t(()=>l[18]||(l[18]=[r("取消",-1)])),_:1,__:[18]}),e(p,{type:"primary",onClick:O,loading:b.value},{default:t(()=>l[19]||(l[19]=[r(" 确定 ",-1)])),_:1,__:[19]},8,["loading"])]),default:t(()=>[e(J,{ref_key:"menuFormRef",ref:h,model:a,rules:E,"label-width":"100px"},{default:t(()=>[e(k,{gutter:20},{default:t(()=>[e(m,{span:12},{default:t(()=>[e(i,{label:"菜单名称",prop:"name"},{default:t(()=>[e(y,{modelValue:a.name,"onUpdate:modelValue":l[1]||(l[1]=n=>a.name=n)},null,8,["modelValue"])]),_:1})]),_:1}),e(m,{span:12},{default:t(()=>[e(i,{label:"菜单路径",prop:"path"},{default:t(()=>[e(y,{modelValue:a.path,"onUpdate:modelValue":l[2]||(l[2]=n=>a.path=n)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(k,{gutter:20},{default:t(()=>[e(m,{span:12},{default:t(()=>[e(i,{label:"菜单图标",prop:"icon"},{default:t(()=>[e(y,{modelValue:a.icon,"onUpdate:modelValue":l[3]||(l[3]=n=>a.icon=n)},null,8,["modelValue"])]),_:1})]),_:1}),e(m,{span:12},{default:t(()=>[e(i,{label:"菜单类型",prop:"type"},{default:t(()=>[e(A,{modelValue:a.type,"onUpdate:modelValue":l[4]||(l[4]=n=>a.type=n)},{default:t(()=>[e(D,{value:"menu"},{default:t(()=>l[16]||(l[16]=[r("菜单",-1)])),_:1,__:[16]}),e(D,{value:"button"},{default:t(()=>l[17]||(l[17]=[r("按钮",-1)])),_:1,__:[17]})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(k,{gutter:20},{default:t(()=>[e(m,{span:12},{default:t(()=>[e(i,{label:"排序号",prop:"sort"},{default:t(()=>[e(Y,{modelValue:a.sort,"onUpdate:modelValue":l[5]||(l[5]=n=>a.sort=n),min:0},null,8,["modelValue"])]),_:1})]),_:1}),e(m,{span:12},{default:t(()=>[e(i,{label:"是否隐藏",prop:"hidden"},{default:t(()=>[e(G,{modelValue:a.hidden,"onUpdate:modelValue":l[6]||(l[6]=n=>a.hidden=n)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(i,{label:"权限标识",prop:"permission"},{default:t(()=>[e(y,{modelValue:a.permission,"onUpdate:modelValue":l[7]||(l[7]=n=>a.permission=n)},null,8,["modelValue"])]),_:1}),e(i,{label:"父级菜单",prop:"parentId"},{default:t(()=>[e(H,{modelValue:a.parentId,"onUpdate:modelValue":l[8]||(l[8]=n=>a.parentId=n),data:N.value,props:{value:"id",label:"name",children:"children"},placeholder:"请选择父级菜单",clearable:""},null,8,["modelValue","data"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},_e=P(ue,[["__scopeId","data-v-5e4330cf"]]);export{_e as default};
