import{_ as ae,i as p,Y as C,m as te,a as oe,o as j,b as e,w as a,d as V,ab as re,r,f as n,e as x,aa as ne,$ as se,ac as de,n as q,t as T,a1 as ie,ae as ue,a4 as me,E as f,a2 as pe}from"./main-0j-tL-il.js";const fe={class:"enterprise-member"},_e={class:"card-header"},ge={class:"header-actions"},ve={class:"search-area"},ce={class:"pagination"},be={__name:"Member",setup(ye){const M=p(!1),z=p(!1),U=p(!1),y=p(!1),w=p(!1),F=p(),h=p(),B=p([]),N=p(null),c=C({name:"",role:""}),v=C({page:1,size:10,total:0}),s=C({email:"",role:"member",department:"",remark:""}),_=C({name:"",role:"",department:""}),S={email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱格式",trigger:"blur"}],role:[{required:!0,message:"请选择角色",trigger:"change"}]},O={name:[{required:!0,message:"请输入姓名",trigger:"blur"}],role:[{required:!0,message:"请选择角色",trigger:"change"}]},A=o=>({admin:"danger",manager:"warning",member:"info"})[o]||"info",P=o=>({admin:"管理员",manager:"项目经理",member:"普通成员"})[o]||"未知",g=async()=>{try{M.value=!0;const o=[{id:1,name:"张三",email:"zhangsan@example.com",phone:"13800138000",role:"admin",department:"技术部",joinTime:"2024-01-01 10:00:00",status:"active",avatar:""},{id:2,name:"李四",email:"lisi@example.com",phone:"13800138001",role:"manager",department:"产品部",joinTime:"2024-01-02 10:00:00",status:"active",avatar:""}];B.value=o,v.total=o.length}catch(o){console.error("加载成员列表失败:",o),f.error("加载成员列表失败")}finally{M.value=!1}},Y=()=>{Object.assign(c,{name:"",role:""}),v.page=1,g()},G=async()=>{try{await F.value.validate(),z.value=!0,f.success("邀请已发送"),y.value=!1,Q(),g()}catch(o){console.error("发送邀请失败:",o),f.error("发送邀请失败")}finally{z.value=!1}},H=o=>{N.value=o,Object.assign(_,{name:o.name,role:o.role,department:o.department}),w.value=!0},J=async()=>{try{await h.value.validate(),U.value=!0,f.success("成员信息更新成功"),w.value=!1,g()}catch(o){console.error("更新成员失败:",o),f.error("更新成员失败")}finally{U.value=!1}},K=async o=>{try{f.success(`已重新发送邀请给 ${o.email}`)}catch{f.error("重发邀请失败")}},L=async o=>{try{await pe.confirm(`确定要移除成员 ${o.name} 吗？`,"确认操作",{type:"warning"}),f.success("成员移除成功"),g()}catch(l){l!=="cancel"&&(console.error("移除成员失败:",l),f.error("移除成员失败"))}},Q=()=>{var o;Object.assign(s,{email:"",role:"member",department:"",remark:""}),(o=F.value)==null||o.resetFields()};return te(()=>{g()}),(o,l)=>{const k=r("el-icon"),d=r("el-button"),b=r("el-input"),i=r("el-form-item"),u=r("el-option"),$=r("el-select"),R=r("el-form"),W=r("el-avatar"),m=r("el-table-column"),D=r("el-tag"),X=r("el-table"),Z=r("el-pagination"),ee=r("el-card"),E=r("el-dialog"),le=de("loading");return j(),oe("div",fe,[e(ee,null,{header:a(()=>[V("div",_e,[e(k,null,{default:a(()=>[e(x(ue))]),_:1}),l[17]||(l[17]=V("span",null,"成员管理",-1)),V("div",ge,[e(d,{type:"primary",onClick:l[0]||(l[0]=t=>y.value=!0)},{default:a(()=>[e(k,null,{default:a(()=>[e(x(me))]),_:1}),l[16]||(l[16]=n(" 邀请成员 ",-1))]),_:1,__:[16]})])])]),default:a(()=>[V("div",ve,[e(R,{model:c,inline:""},{default:a(()=>[e(i,{label:"姓名"},{default:a(()=>[e(b,{modelValue:c.name,"onUpdate:modelValue":l[1]||(l[1]=t=>c.name=t),placeholder:"请输入姓名",clearable:""},null,8,["modelValue"])]),_:1}),e(i,{label:"角色"},{default:a(()=>[e($,{modelValue:c.role,"onUpdate:modelValue":l[2]||(l[2]=t=>c.role=t),placeholder:"请选择角色",clearable:""},{default:a(()=>[e(u,{label:"管理员",value:"admin"}),e(u,{label:"项目经理",value:"manager"}),e(u,{label:"普通成员",value:"member"})]),_:1},8,["modelValue"])]),_:1}),e(i,null,{default:a(()=>[e(d,{type:"primary",onClick:g},{default:a(()=>[e(k,null,{default:a(()=>[e(x(ne))]),_:1}),l[18]||(l[18]=n(" 搜索 ",-1))]),_:1,__:[18]}),e(d,{onClick:Y},{default:a(()=>[e(k,null,{default:a(()=>[e(x(se))]),_:1}),l[19]||(l[19]=n(" 重置 ",-1))]),_:1,__:[19]})]),_:1})]),_:1},8,["model"])]),re((j(),q(X,{data:B.value,style:{width:"100%"}},{default:a(()=>[e(m,{prop:"avatar",label:"头像",width:"80"},{default:a(t=>[e(W,{size:40,src:t.row.avatar},{default:a(()=>[n(T(t.row.name.charAt(0)),1)]),_:2},1032,["src"])]),_:1}),e(m,{prop:"name",label:"姓名",width:"120"}),e(m,{prop:"email",label:"邮箱",width:"200"}),e(m,{prop:"phone",label:"手机号",width:"130"}),e(m,{prop:"role",label:"角色",width:"120"},{default:a(t=>[e(D,{type:A(t.row.role)},{default:a(()=>[n(T(P(t.row.role)),1)]),_:2},1032,["type"])]),_:1}),e(m,{prop:"department",label:"部门",width:"120"}),e(m,{prop:"joinTime",label:"加入时间",width:"160"}),e(m,{prop:"status",label:"状态",width:"100"},{default:a(t=>[e(D,{type:t.row.status==="active"?"success":"warning"},{default:a(()=>[n(T(t.row.status==="active"?"正常":"待激活"),1)]),_:2},1032,["type"])]),_:1}),e(m,{label:"操作",width:"200",fixed:"right"},{default:a(t=>[e(d,{type:"primary",size:"small",onClick:I=>H(t.row)},{default:a(()=>l[20]||(l[20]=[n(" 编辑 ",-1)])),_:2,__:[20]},1032,["onClick"]),t.row.status==="pending"?(j(),q(d,{key:0,type:"success",size:"small",onClick:I=>K(t.row)},{default:a(()=>l[21]||(l[21]=[n(" 重发邀请 ",-1)])),_:2,__:[21]},1032,["onClick"])):ie("",!0),e(d,{type:"danger",size:"small",onClick:I=>L(t.row)},{default:a(()=>l[22]||(l[22]=[n(" 移除 ",-1)])),_:2,__:[22]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[le,M.value]]),V("div",ce,[e(Z,{"current-page":v.page,"onUpdate:currentPage":l[3]||(l[3]=t=>v.page=t),"page-size":v.size,"onUpdate:pageSize":l[4]||(l[4]=t=>v.size=t),"page-sizes":[10,20,50,100],total:v.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:g,onCurrentChange:g},null,8,["current-page","page-size","total"])])]),_:1}),e(E,{modelValue:y.value,"onUpdate:modelValue":l[10]||(l[10]=t=>y.value=t),title:"邀请成员",width:"500px"},{footer:a(()=>[e(d,{onClick:l[9]||(l[9]=t=>y.value=!1)},{default:a(()=>l[23]||(l[23]=[n("取消",-1)])),_:1,__:[23]}),e(d,{type:"primary",onClick:G,loading:z.value},{default:a(()=>l[24]||(l[24]=[n(" 发送邀请 ",-1)])),_:1,__:[24]},8,["loading"])]),default:a(()=>[e(R,{ref_key:"inviteFormRef",ref:F,model:s,rules:S,"label-width":"100px"},{default:a(()=>[e(i,{label:"邮箱",prop:"email"},{default:a(()=>[e(b,{modelValue:s.email,"onUpdate:modelValue":l[5]||(l[5]=t=>s.email=t),placeholder:"请输入成员邮箱"},null,8,["modelValue"])]),_:1}),e(i,{label:"角色",prop:"role"},{default:a(()=>[e($,{modelValue:s.role,"onUpdate:modelValue":l[6]||(l[6]=t=>s.role=t),placeholder:"请选择角色",style:{width:"100%"}},{default:a(()=>[e(u,{label:"普通成员",value:"member"}),e(u,{label:"项目经理",value:"manager"}),e(u,{label:"管理员",value:"admin"})]),_:1},8,["modelValue"])]),_:1}),e(i,{label:"部门",prop:"department"},{default:a(()=>[e(b,{modelValue:s.department,"onUpdate:modelValue":l[7]||(l[7]=t=>s.department=t),placeholder:"请输入部门"},null,8,["modelValue"])]),_:1}),e(i,{label:"备注",prop:"remark"},{default:a(()=>[e(b,{modelValue:s.remark,"onUpdate:modelValue":l[8]||(l[8]=t=>s.remark=t),type:"textarea",rows:3,placeholder:"请输入备注信息"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),e(E,{modelValue:w.value,"onUpdate:modelValue":l[15]||(l[15]=t=>w.value=t),title:"编辑成员",width:"500px"},{footer:a(()=>[e(d,{onClick:l[14]||(l[14]=t=>w.value=!1)},{default:a(()=>l[25]||(l[25]=[n("取消",-1)])),_:1,__:[25]}),e(d,{type:"primary",onClick:J,loading:U.value},{default:a(()=>l[26]||(l[26]=[n(" 保存 ",-1)])),_:1,__:[26]},8,["loading"])]),default:a(()=>[e(R,{ref_key:"editFormRef",ref:h,model:_,rules:O,"label-width":"100px"},{default:a(()=>[e(i,{label:"姓名",prop:"name"},{default:a(()=>[e(b,{modelValue:_.name,"onUpdate:modelValue":l[11]||(l[11]=t=>_.name=t),placeholder:"请输入姓名"},null,8,["modelValue"])]),_:1}),e(i,{label:"角色",prop:"role"},{default:a(()=>[e($,{modelValue:_.role,"onUpdate:modelValue":l[12]||(l[12]=t=>_.role=t),placeholder:"请选择角色",style:{width:"100%"}},{default:a(()=>[e(u,{label:"普通成员",value:"member"}),e(u,{label:"项目经理",value:"manager"}),e(u,{label:"管理员",value:"admin"})]),_:1},8,["modelValue"])]),_:1}),e(i,{label:"部门",prop:"department"},{default:a(()=>[e(b,{modelValue:_.department,"onUpdate:modelValue":l[13]||(l[13]=t=>_.department=t),placeholder:"请输入部门"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},Ve=ae(be,[["__scopeId","data-v-68f187fd"]]);export{Ve as default};
